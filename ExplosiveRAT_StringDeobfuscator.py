#####################################
# Author: KrknSec                   #
# Description: String de-obfuscator #
# script for the Explosive RAT      #
# created by the Lebanese Cedar APT #
# group.                            #
#####################################

import string
import sys
import re
from typing import Pattern
import base64

pattern = r'Exploiter'

f = open(sys.argv[1], 'r').readlines()

for line in f:
  
  # Remove null bytes because strings are stored in Unicode in the binary
  new_line = re.sub(r'[\x00]', "", line)
  
  # Search for the Exploiter tag
  match = re.search(pattern, new_line)
  
  if match:
    
    # Remove the Exploiter tag
    reversed_base64 = re.sub(pattern, "", new_line)
    
    # Reverse the Base64
    rev = reversed_base64[::-1]
    
    # Decode the Base64
    decoded = base64.b64decode(rev + '==')
    decodedStr = str(decoded, "utf-8", errors='ignore')
    
    # Reverse the readable string and print
    revAgain = decodedStr[::-1]
    print(revAgain)
